# HiPart is a software toolkit to analyse molecular densities with the hirshfeld partitioning scheme.
# Copyright (C) 2007 - 2010 Toon Verstraelen <Toon.Verstraelen@UGent.be>
#
# This file is part of HiPart.
#
# HiPart is free software; you can redistribute it and/or
# modify it under the terms of the GNU General Public License
# as published by the Free Software Foundation; either version 3
# of the License, or (at your option) any later version.
#
# HiPart is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program; if not, see <http://www.gnu.org/licenses/>
#
# --


from hipart.cache import cache_classes
from hipart.context import Context

import os, tempfile, shutil


__all__ = [
    "FakeOptions",
    "setup_hf_sto3g_gaussian", "iter_hf_sto3g_gaussian_caches",
    "setup_oh1_sto3g_gaussian", "iter_oh1_sto3g_gaussian_caches",
    "setup_oh2_sto3g_gaussian", "iter_oh2_sto3g_gaussian_caches",
    "setup_h_sto3g_gaussian", "iter_h_sto3g_gaussian_caches",
]


class FakeOptions(object):
    def __init__(self, lebedev, mol_lebedev, clean, threshold, max_iter, fix_total_charge):
        self.lebedev = lebedev
        self.mol_lebedev = mol_lebedev
        self.clean = clean
        self.threshold = threshold
        self.max_iter = max_iter
        self.fix_total_charge = fix_total_charge


hf_fchk="""\
hf
SP        RHF                                                         STO-3G
Number of atoms                            I                2
Charge                                     I                0
Multiplicity                               I                1
Number of electrons                        I               10
Number of alpha electrons                  I                5
Number of beta electrons                   I                5
Number of basis functions                  I                6
Number of independant functions            I                6
Number of contracted shells                I                3
Highest angular momentum                   I                1
Largest degree of contraction              I                3
Number of primitive shells                 I                9
SCF Energy                                 R     -9.856961609951867E+01
Total Energy                               R     -9.856961609951867E+01
Atomic numbers                             I   N=           2
           9           1
Nuclear charges                            R   N=           2
  9.00000000E+00  1.00000000E+00
Current cartesian coordinates              R   N=           6
  0.00000000E+00  0.00000000E+00  1.90484394E-01  0.00000000E+00  0.00000000E+00
 -1.71435955E+00
Shell types                                I   N=           3
           0          -1           0
Number of primitives per shell             I   N=           3
           3           3           3
Shell to atom map                          I   N=           3
           1           1           2
Primitive exponents                        R   N=           9
  1.66679134E+02  3.03608123E+01  8.21682067E+00  6.46480325E+00  1.50228124E+00
  4.88588486E-01  3.42525091E+00  6.23913730E-01  1.68855404E-01
Contraction coefficients                   R   N=           9
  1.54328967E-01  5.35328142E-01  4.44634542E-01 -9.99672292E-02  3.99512826E-01
  7.00115469E-01  1.54328967E-01  5.35328142E-01  4.44634542E-01
P(S=P) Contraction coefficients            R   N=           9
  0.00000000E+00  0.00000000E+00  0.00000000E+00  1.55916275E-01  6.07683719E-01
  3.91957393E-01  0.00000000E+00  0.00000000E+00  0.00000000E+00
Alpha Orbital Energies                     R   N=           6
 -2.59083334E+01 -1.44689996E+00 -5.57467136E-01 -4.62288194E-01 -4.62288194E-01
  5.39578910E-01
Alpha MO coefficients                      R   N=          36
  9.94803448E-01  2.18171240E-02  0.00000000E+00  0.00000000E+00 -2.32641328E-03
 -4.79956235E-03 -2.52541943E-01  9.59473606E-01  0.00000000E+00  0.00000000E+00
 -6.43303484E-02  1.39537839E-01 -7.25975847E-02  3.79097630E-01  0.00000000E+00
  0.00000000E+00  6.93582825E-01 -5.48754967E-01  0.00000000E+00  0.00000000E+00
  1.00000000E+00  0.00000000E+00  0.00000000E+00  0.00000000E+00  0.00000000E+00
  0.00000000E+00  0.00000000E+00  1.00000000E+00  0.00000000E+00  0.00000000E+00
  7.48777677E-02 -4.62627490E-01  0.00000000E+00  0.00000000E+00  8.05942415E-01
  1.01124712E+00
Total SCF Density                          R   N=          21
  2.11736348E+00 -4.96250301E-01  2.12956120E+00  0.00000000E+00  0.00000000E+00
  2.00000000E+00  0.00000000E+00  0.00000000E+00  0.00000000E+00  2.00000000E+00
 -7.28413014E-02  4.02323157E-01  0.00000000E+00  0.00000000E+00  9.70401883E-01
 -3.50985618E-04 -1.48507094E-01  0.00000000E+00  0.00000000E+00 -7.79144745E-01
  6.41251717E-01
Dipole Moment                              R   N=           3
  0.00000000E+00  0.00000000E+00 -4.73896291E-01
"""


oh1_fchk = """\
foo
SP        ROHF                                                        STO-3G
Number of atoms                            I                2
Charge                                     I                0
Multiplicity                               I                2
Number of electrons                        I                9
Number of alpha electrons                  I                5
Number of beta electrons                   I                4
Number of basis functions                  I                6
Number of independant functions            I                6
Number of contracted shells                I                3
Highest angular momentum                   I                1
Largest degree of contraction              I                3
Number of primitive shells                 I                9
Virial Ratio                               R      2.004584116380540E+00
SCF Energy                                 R     -7.436007700203925E+01
Total Energy                               R     -7.436007700203925E+01
S**2                                       R      7.500000000000058E-01
S**2 after annihilation                    R      7.499999999999949E-01
RMS Density                                R      8.977997710693391E-06
Atomic numbers                             I   N=           2
           8           1
Nuclear charges                            R   N=           2
  8.00000000E+00  1.00000000E+00
Current cartesian coordinates              R   N=           6
  0.00000000E+00  0.00000000E+00  2.01087858E-01  0.00000000E+00  0.00000000E+00
 -1.60870286E+00
Shell types                                I   N=           3
           0          -1           0
Number of primitives per shell             I   N=           3
           3           3           3
Shell to atom map                          I   N=           3
           1           1           2
Primitive exponents                        R   N=           9
  1.30709321E+02  2.38088661E+01  6.44360831E+00  5.03315132E+00  1.16959612E+00
  3.80388960E-01  3.42525091E+00  6.23913730E-01  1.68855404E-01
Contraction coefficients                   R   N=           9
  1.54328967E-01  5.35328142E-01  4.44634542E-01 -9.99672292E-02  3.99512826E-01
  7.00115469E-01  1.54328967E-01  5.35328142E-01  4.44634542E-01
P(S=P) Contraction coefficients            R   N=           9
  0.00000000E+00  0.00000000E+00  0.00000000E+00  1.55916275E-01  6.07683719E-01
  3.91957393E-01  0.00000000E+00  0.00000000E+00  0.00000000E+00
Coordinates of each shell                  R   N=           9
  0.00000000E+00  0.00000000E+00  2.01087858E-01  0.00000000E+00  0.00000000E+00
  2.01087858E-01  0.00000000E+00  0.00000000E+00 -1.60870286E+00
Alpha Orbital Energies                     R   N=           6
 -2.02663104E+01 -1.18778950E+00 -5.21473569E-01 -3.96170372E-01 -5.50728969E-02
  6.44671667E-01
Alpha MO coefficients                      R   N=          36
  9.94626793E-01  2.33409383E-02  0.00000000E+00  0.00000000E+00 -3.79842004E-03
 -6.61606376E-03 -2.39714989E-01  8.87266774E-01  0.00000000E+00  0.00000000E+00
 -1.24903736E-01  2.13188291E-01 -1.00792420E-01  5.15738267E-01  0.00000000E+00
  0.00000000E+00  6.79754872E-01 -5.07836052E-01  0.00000000E+00  0.00000000E+00
  0.00000000E+00  1.00000000E+00  0.00000000E+00  0.00000000E+00  0.00000000E+00
  0.00000000E+00  1.00000000E+00  0.00000000E+00  0.00000000E+00  0.00000000E+00
  9.30392802E-02 -6.27364884E-01  0.00000000E+00  0.00000000E+00  8.79296022E-01
  1.14823048E+00
Total SCF Density                          R   N=          21
  1.05690485E+00 -2.41458130E-01  1.05377309E+00  0.00000000E+00  0.00000000E+00
  1.00000000E+00  0.00000000E+00  0.00000000E+00  0.00000000E+00  1.00000000E+00
 -4.23508510E-02  2.39664006E-01  0.00000000E+00  0.00000000E+00  4.77682057E-01
 -6.49891854E-03 -7.29100230E-02  0.00000000E+00  0.00000000E+00 -3.71806914E-01
  3.03390475E-01
Dipole Moment                              R   N=           3
  0.00000000E+00  0.00000000E+00 -5.07693653E-01"""


oh2_fchk = """\
foo
SP        UHF                                                         STO-3G
Number of atoms                            I                2
Charge                                     I                0
Multiplicity                               I                2
Number of electrons                        I                9
Number of alpha electrons                  I                5
Number of beta electrons                   I                4
Number of basis functions                  I                6
Number of independant functions            I                6
Number of contracted shells                I                3
Highest angular momentum                   I                1
Largest degree of contraction              I                3
Number of primitive shells                 I                9
Virial Ratio                               R      2.004601758689300E+00
SCF Energy                                 R     -7.436116574636311E+01
Total Energy                               R     -7.436116574636311E+01
S**2                                       R      7.530160094011968E-01
S**2 after annihilation                    R      7.499999999999854E-01
RMS Density                                R      4.253052492946908E-04
Atomic numbers                             I   N=           2
           8           1
Nuclear charges                            R   N=           2
  8.00000000E+00  1.00000000E+00
Current cartesian coordinates              R   N=           6
  0.00000000E+00  0.00000000E+00  2.01087858E-01  0.00000000E+00  0.00000000E+00
 -1.60870286E+00
Shell types                                I   N=           3
           0          -1           0
Number of primitives per shell             I   N=           3
           3           3           3
Shell to atom map                          I   N=           3
           1           1           2
Primitive exponents                        R   N=           9
  1.30709321E+02  2.38088661E+01  6.44360831E+00  5.03315132E+00  1.16959612E+00
  3.80388960E-01  3.42525091E+00  6.23913730E-01  1.68855404E-01
Contraction coefficients                   R   N=           9
  1.54328967E-01  5.35328142E-01  4.44634542E-01 -9.99672292E-02  3.99512826E-01
  7.00115469E-01  1.54328967E-01  5.35328142E-01  4.44634542E-01
P(S=P) Contraction coefficients            R   N=           9
  0.00000000E+00  0.00000000E+00  0.00000000E+00  1.55916275E-01  6.07683719E-01
  3.91957393E-01  0.00000000E+00  0.00000000E+00  0.00000000E+00
Coordinates of each shell                  R   N=           9
  0.00000000E+00  0.00000000E+00  2.01087858E-01  0.00000000E+00  0.00000000E+00
  2.01087858E-01  0.00000000E+00  0.00000000E+00 -1.60870286E+00
Alpha Orbital Energies                     R   N=           6
 -2.02850453E+01 -1.29590853E+00 -5.53744083E-01 -5.24956112E-01 -4.30067224E-01
  6.32677753E-01
Beta Orbital Energies                      R   N=           6
 -2.02565946E+01 -1.13271582E+00 -5.05316759E-01 -3.78250103E-01  3.59575654E-01
  6.68548659E-01
Alpha MO coefficients                      R   N=          36
  9.94266794E-01  2.48147786E-02  0.00000000E+00  0.00000000E+00 -3.90932760E-03
 -6.91535080E-03 -2.46670414E-01  9.20063389E-01  0.00000000E+00  0.00000000E+00
 -1.15476493E-01  1.68822174E-01 -8.98413185E-02  4.68633688E-01  0.00000000E+00
  0.00000000E+00  6.99702718E-01 -4.95493556E-01  0.00000000E+00  0.00000000E+00
  1.00000000E+00  0.00000000E+00  0.00000000E+00  0.00000000E+00  0.00000000E+00
  0.00000000E+00  0.00000000E+00  1.00000000E+00  0.00000000E+00  0.00000000E+00
  8.98717940E-02 -6.16935846E-01  0.00000000E+00  0.00000000E+00  8.64817642E-01
  1.16093113E+00
Beta MO coefficients                       R   N=          36
  9.94821161E-01  2.25101424E-02  0.00000000E+00  0.00000000E+00 -3.61993202E-03
 -6.31368233E-03 -2.34464044E-01  8.60158617E-01  0.00000000E+00  0.00000000E+00
 -1.20553720E-01  2.51547643E-01 -1.07687799E-01  5.46428719E-01  0.00000000E+00
  0.00000000E+00  6.62941723E-01 -5.20224255E-01  0.00000000E+00  0.00000000E+00
  0.00000000E+00  1.00000000E+00  0.00000000E+00  0.00000000E+00  0.00000000E+00
  0.00000000E+00  1.00000000E+00  0.00000000E+00  0.00000000E+00  0.00000000E+00
  9.65503007E-02 -6.39058594E-01  0.00000000E+00  0.00000000E+00  8.92639636E-01
  1.13484552E+00
Total SCF Density                          R   N=          21
  2.11372341E+00 -4.82508983E-01  2.10571384E+00  0.00000000E+00  0.00000000E+00
  1.00000000E+00  0.00000000E+00  0.00000000E+00  0.00000000E+00  2.00000000E+00
 -8.49909024E-02  4.80035153E-01  0.00000000E+00  0.00000000E+00  9.56972029E-01
 -1.32414023E-02 -1.45086196E-01  0.00000000E+00  0.00000000E+00 -7.41346659E-01
  6.08011967E-01
Spin SCF Density                           R   N=          21
  1.24502121E-03 -6.25616822E-03  2.77860492E-02  0.00000000E+00  0.00000000E+00
  1.00000000E+00  0.00000000E+00  0.00000000E+00  0.00000000E+00  0.00000000E+00
  8.46191231E-03 -3.69120275E-02  0.00000000E+00  0.00000000E+00  4.88959654E-02
  5.23471257E-03 -9.01275220E-03  0.00000000E+00  0.00000000E+00  9.01436638E-03
 -5.98867416E-02
Dipole Moment                              R   N=           3
  0.00000000E+00  0.00000000E+00 -5.08603120E-01"""


h_fchk = """\
h
SP        UHF                                                         STO-3G
Number of atoms                            I                1
Charge                                     I                0
Multiplicity                               I                2
Number of electrons                        I                1
Number of alpha electrons                  I                1
Number of beta electrons                   I                0
Number of basis functions                  I                1
Number of contracted shells                I                1
Highest angular momentum                   I                0
Largest degree of contraction              I                3
Number of primitive shells                 I                3
Virial Ratio                               R      1.613897736040718E+00
SCF Energy                                 R     -4.665818503844346E-01
Total Energy                               R     -4.665818503844346E-01
Atomic numbers                             I   N=           1
           1
Nuclear charges                            R   N=           1
  1.00000000E+00
Current cartesian coordinates              R   N=           3
  0.00000000E+00  0.00000000E+00  0.00000000E+00
Integer atomic weights                     I   N=           1
           1
Real atomic weights                        R   N=           1
  1.00782504E+00
Shell types                                I   N=           1
           0
Number of primitives per shell             I   N=           1
           3
Shell to atom map                          I   N=           1
           1
Primitive exponents                        R   N=           3
  3.42525091E+00  6.23913730E-01  1.68855404E-01
Contraction coefficients                   R   N=           3
  1.54328967E-01  5.35328142E-01  4.44634542E-01
Coordinates of each shell                  R   N=           3
  0.00000000E+00  0.00000000E+00  0.00000000E+00
Alpha Orbital Energies                     R   N=           1
 -4.66581850E-01
Beta Orbital Energies                      R   N=           1
  3.08024094E-01
Alpha MO coefficients                      R   N=           1
  1.00000000E+00
Beta MO coefficients                       R   N=           1
  1.00000000E+00
Total SCF Density                          R   N=           1
  1.00000000E+00
Spin SCF Density                           R   N=           1
  1.00000000E+00
Dipole Moment                              R   N=           3
  0.00000000E+00  0.00000000E+00  0.00000000E+00"""


densities_txt="""\
RLogIntGrid(3.7794522678425048e-05,3.7794522678425039e+01,100)
  1 -1 7.8938827270500256e-01 7.8938827139900203e-01 7.8938826967299691e-01 7.8938826739199852e-01 7.8938826437499976e-01 7.8938826038799648e-01 7.8938825511800070e-01 7.8938824815000097e-01 7.8938823893899968e-01 7.8938822676300013e-01 7.8938821066600007e-01 7.8938818938800259e-01 7.8938816125999522e-01 7.8938812407500003e-01 7.8938807491900076e-01 7.8938800993900293e-01 7.8938792403799907e-01 7.8938781048200235e-01 7.8938766036799701e-01 7.8938746192600295e-01 7.8938719959799541e-01 7.8938685281500376e-01 7.8938639438899705e-01 7.8938578837800499e-01 7.8938498726699846e-01 7.8938392824799630e-01 7.8938252829000166e-01 7.8938067763299824e-01 7.8937823118099881e-01 7.8937499713200143e-01 7.8937072193699742e-01 7.8936507042699533e-01 7.8935759954499896e-01 7.8934772362400019e-01 7.8933466848800204e-01 7.8931741080699813e-01 7.8929459793600276e-01 7.8926444200400081e-01 7.8922457998099882e-01 7.8917188882999567e-01 7.8910224138700247e-01 7.8901018407400203e-01 7.8888851157700413e-01 7.8872770587599872e-01 7.8851519690399752e-01 7.8823438906099963e-01 7.8786338111185572e-01 7.8737328578900256e-01 7.8672602900400335e-01 7.8587147638799970e-01 7.8474369709000114e-01 7.8325613290070395e-01 7.8129539943117765e-01 7.7871341498113023e-01 7.7531755133578395e-01 7.7085856456009338e-01 7.6501625482915536e-01 7.5738322493164723e-01 7.4744791716875791e-01 7.3457953763906059e-01 7.1801981321653718e-01 6.9689003293849283e-01 6.7022649475261686e-01 6.3706247968028673e-01 5.9657755202267637e-01 5.4832952775605803e-01 4.9256131527139951e-01 4.3052395708658708e-01 3.6468029108188621e-01 2.9858738197148782e-01 2.3628803600198417e-01 1.8126708527727881e-01 1.3540428066621779e-01 9.8584312147321343e-02 6.9344193761975231e-02 4.6169214192004988e-02 2.8374448029361159e-02 1.5812231085177895e-02 7.9779437039380601e-03 3.6998898371167410e-03 1.6022269647777926e-03 6.3623822399999999e-04 2.1463808699999983e-04 5.4569860999999913e-05 9.1208690000000148e-06 8.6052400000000538e-07 3.7983000000000030e-08 6.1400000000000109e-10 3.0000000000000155e-12
  1 +0 3.9469413635199962e-01 3.9469413569999989e-01 3.9469413483700144e-01 3.9469413369599926e-01 3.9469413218799804e-01 3.9469413019399824e-01 3.9469412755900035e-01 3.9469412407500049e-01 3.9469411946900046e-01 3.9469411338100135e-01 3.9469410533300003e-01 3.9469409469400130e-01 3.9469408062999761e-01 3.9469406203799962e-01 3.9469403746000004e-01 3.9469400496899981e-01 3.9469396201899953e-01 3.9469390524100118e-01 3.9469383018399851e-01 3.9469373096300148e-01 3.9469359979899771e-01 3.9469342640800065e-01 3.9469319719499918e-01 3.9469289418900250e-01 3.9469249363400039e-01 3.9469196412399815e-01 3.9469126414500083e-01 3.9469033881600019e-01 3.9468911559100012e-01 3.9468749856600072e-01 3.9468536096799939e-01 3.9468253521300023e-01 3.9467879977300041e-01 3.9467386181200009e-01 3.9466733424400102e-01 3.9465870540399978e-01 3.9464729896800138e-01 3.9463222100200041e-01 3.9461228999099862e-01 3.9458594441499784e-01 3.9455112069299964e-01 3.9450509203700102e-01 3.9444425578799880e-01 3.9436385293799936e-01 3.9425759845199876e-01 3.9411719453000049e-01 3.9393169055600125e-01 3.9368664289498134e-01 3.9336301450200167e-01 3.9293573819399985e-01 3.9237184854500057e-01 3.9162806644999959e-01 3.9064769971599772e-01 3.8935670749093926e-01 3.8765877566799856e-01 3.8542928227999973e-01 3.8250812741471035e-01 3.7869161246598776e-01 3.7372395858428897e-01 3.6728976881954101e-01 3.5900990660810544e-01 3.4844501646917558e-01 3.3511324737633208e-01 3.1853123984030107e-01 2.9828877601174247e-01 2.7416476387814764e-01 2.4628065763563992e-01 2.1526197854363216e-01 1.8234014554106262e-01 1.4929369098588832e-01 1.1814401800102679e-01 9.0633542638738185e-02 6.7702140333142327e-02 4.9292156073641999e-02 3.4672096881018848e-02 2.3084607096058384e-02 1.4187224014813496e-02 7.9061155428923717e-03 3.9889718519675104e-03 1.8499449187952106e-03 8.0111348200607763e-04 3.1811911199999999e-04 1.0731904399999953e-04 2.7284929999999941e-05 4.5604340000000263e-06 4.3026200000000269e-07 1.8990999999999942e-08 3.0700000000000054e-10 9.9999999999999675e-13
  8 -2 1.9423029839879698e+02 1.9423028606009737e+02 1.9423026974906620e+02 1.9423024818684212e+02 1.9423021968285943e+02 1.9423018200227818e+02 1.9423013219078220e+02 1.9423006634294381e+02 1.9422997929601934e+02 1.9422986422518832e+02 1.9422971210846157e+02 1.9422951101934052e+02 1.9422924519178019e+02 1.9422889378412873e+02 1.9422842924518335e+02 1.9422781515429014e+02 1.9422700336621011e+02 1.9422593023702566e+02 1.9422451163543133e+02 1.9422263634863091e+02 1.9422015736658170e+02 1.9421688036239956e+02 1.9421254846791160e+02 1.9420682215437128e+02 1.9419925264743574e+02 1.9418924680334464e+02 1.9417602071230408e+02 1.9415853842602561e+02 1.9413543106594000e+02 1.9410489007554429e+02 1.9406452643199933e+02 1.9401118510078621e+02 1.9394070074806777e+02 1.9384757653806477e+02 1.9372456254048890e+02 1.9356210366877770e+02 1.9334761903988954e+02 1.9306456524034999e+02 1.9269122562689194e+02 1.9219915764940797e+02 1.9155122279888388e+02 1.9069912412353193e+02 1.8958039341685668e+02 1.8811481995561263e+02 1.8620042110571848e+02 1.8370926270513939e+02 1.8048380172514237e+02 1.7633501700585688e+02 1.7104447935930864e+02 1.6437368131074180e+02 1.5608517570627129e+02 1.4598066830122809e+02 1.3395968062564759e+02 1.2009633601107943e+02 1.0471878447403172e+02 8.8456505844578828e+01 7.2204983840558526e+01 5.6967439110567554e+01 4.3592238932164669e+01 3.2518461488342254e+01 2.3693335377159904e+01 1.6746416261022027e+01 1.1310569698835778e+01 7.2225819182266227e+00 4.4319809751440058e+00 2.7810245848127932e+00 1.9455622321535166e+00 1.5638103939812329e+00 1.3706016302597543e+00 1.2271598798480461e+00 1.0792394590452163e+00 9.1305970212515875e-01 7.3304791926988799e-01 5.4998923885826423e-01 3.7624975461210386e-01 2.2774751531487430e-01 1.1963830165772131e-01 5.4808944999807853e-02 2.2369569616062446e-02 8.1045912710220620e-03 2.4160298416734277e-03 5.1143634961374723e-04 6.4135326999999664e-05 3.8922329999999983e-06 8.9464999999999630e-08 5.6700000000000114e-10 9.9999999999999675e-13
  8 -1 1.9423029839480358e+02 1.9423028605481872e+02 1.9423026974208702e+02 1.9423024817761817e+02 1.9423021967066452e+02 1.9423018198615765e+02 1.9423013216947257e+02 1.9423006631477247e+02 1.9422997925877988e+02 1.9422986417596007e+02 1.9422971204338305e+02 1.9422951093331187e+02 1.9422924507805533e+02 1.9422889363379059e+02 1.9422842904644529e+02 1.9422781489157103e+02 1.9422700301891041e+02 1.9422592977791760e+02 1.9422451102851639e+02 1.9422263554632573e+02 1.9422015630598167e+02 1.9421687896035104e+02 1.9421254661448754e+02 1.9420681970425829e+02 1.9419924940853659e+02 1.9418924252172118e+02 1.9417601505226816e+02 1.9415853094382348e+02 1.9413542117496652e+02 1.9410487700035955e+02 1.9406450914755129e+02 1.9401116225206721e+02 1.9394067054394148e+02 1.9384753661092068e+02 1.9372450976078451e+02 1.9356203389996523e+02 1.9334752681460142e+02 1.9306444333264793e+02 1.9269106448729502e+02 1.9219894465890869e+02 1.9155094128439882e+02 1.9069875205904509e+02 1.8957990171119098e+02 1.8811417019714330e+02 1.8619956259554431e+02 1.8370812856008166e+02 1.8048230377018359e+02 1.7633303909817405e+02 1.7104186869556580e+02 1.6437023716677567e+02 1.5608063494888904e+02 1.4597468692683566e+02 1.3395181053862794e+02 1.2008599635942852e+02 1.0470522720966682e+02 8.8438776023239456e+01 7.2181876840881429e+01 5.6937459973634034e+01 4.3553574052958197e+01 3.2468980617540204e+01 2.3630652542684221e+01 1.6668050416881346e+01 1.1214254588618443e+01 7.1067679298616140e+00 4.2965289036379097e+00 2.6279876257533505e+00 1.7797838773575210e+00 1.3928996277362355e+00 1.2038702073143230e+00 1.0735538418937327e+00 9.4512372362251973e-01 8.0123810691862962e-01 6.4369825772271105e-01 4.8243680727306493e-01 3.2951359327343810e-01 1.9934250593529759e-01 1.0484536206343326e-01 4.8149111149381446e-02 1.9677633291251734e-02 7.1118392817548530e-03 2.1066178976054234e-03 4.4241388588174015e-04 5.5066673452378225e-05 3.3208123551533520e-06 7.5938287040272311e-08 4.7924927170940713e-10 6.9765898180713926e-13
  8 +0 1.9423029839081039e+02 1.9423028604954058e+02 1.9423026973510900e+02 1.9423024816839370e+02 1.9423021965846996e+02 1.9423018197003719e+02 1.9423013214816257e+02 1.9423006628660210e+02 1.9422997922153976e+02 1.9422986412673100e+02 1.9422971197830552e+02 1.9422951084728314e+02 1.9422924496433046e+02 1.9422889348345285e+02 1.9422842884770819e+02 1.9422781462885209e+02 1.9422700267161164e+02 1.9422592931880868e+02 1.9422451042160171e+02 1.9422263474402098e+02 1.9422015524538267e+02 1.9421687755830285e+02 1.9421254476106412e+02 1.9420681725414477e+02 1.9419924616963721e+02 1.9418923824009778e+02 1.9417600939223240e+02 1.9415852346162228e+02 1.9413541128399407e+02 1.9410486392517700e+02 1.9406449186310286e+02 1.9401113940335028e+02 1.9394064033981854e+02 1.9384749668377734e+02 1.9372445698108095e+02 1.9356196413115075e+02 1.9334743458931513e+02 1.9306432142494785e+02 1.9269090334769663e+02 1.9219873166840983e+02 1.9155065976991432e+02 1.9069837999456288e+02 1.8957941000551756e+02 1.8811352043867856e+02 1.8619870408537716e+02 1.8370699441503740e+02 1.8048080581520603e+02 1.7633106119051436e+02 1.7103925803172436e+02 1.6436679302263778e+02 1.5607609419153619e+02 1.4596870555242313e+02 1.3394394045157955e+02 1.2007565670764086e+02 1.0469166994514961e+02 8.8421046201824282e+01 7.2158769841141066e+01 5.6907480836751233e+01 4.3514909173611294e+01 3.2419499746742105e+01 2.3567969708245087e+01 1.6589684572719097e+01 1.1117939478460677e+01 6.9909539416273914e+00 4.1610768322007008e+00 2.4749506667101473e+00 1.6140055225717547e+00 1.2219888614923675e+00 1.0371387843695725e+00 9.1994780393552877e-01 8.1100798819847852e-01 6.8941651171254259e-01 5.5434859617556398e-01 4.1488437568877740e-01 2.8277743193512406e-01 1.7093749655603618e-01 9.0052422469504151e-02 4.1489277298976827e-02 1.6985696966516240e-02 6.1190872926069973e-03 1.7972059535321921e-03 3.7339142228116022e-04 4.5998019681362838e-05 2.7493921835851287e-06 6.2411422919488342e-08 3.9157899432242635e-10 2.9061584234500354e-13
  8 +1 1.9423029838681705e+02 1.9423028604426133e+02 1.9423026972813116e+02 1.9423024815916909e+02 1.9423021964627651e+02 1.9423018195391720e+02 1.9423013212685302e+02 1.9423006625843047e+02 1.9422997918429905e+02 1.9422986407750088e+02 1.9422971191322867e+02 1.9422951076125415e+02 1.9422924485060622e+02 1.9422889333311511e+02 1.9422842864897078e+02 1.9422781436613275e+02 1.9422700232431268e+02 1.9422592885969965e+02 1.9422450981468816e+02 1.9422263394171546e+02 1.9422015418478375e+02 1.9421687615625478e+02 1.9421254290764074e+02 1.9420681480403107e+02 1.9419924293073706e+02 1.9418923395847366e+02 1.9417600373219685e+02 1.9415851597942046e+02 1.9413540139302123e+02 1.9410485084999328e+02 1.9406447457865312e+02 1.9401111655463285e+02 1.9394061013568913e+02 1.9384745675663135e+02 1.9372440420137627e+02 1.9356189436233916e+02 1.9334734236402991e+02 1.9306419951724996e+02 1.9269074220810202e+02 1.9219851867791104e+02 1.9155037825542507e+02 1.9069800793008153e+02 1.8957891829985198e+02 1.8811287068021579e+02 1.8619784557521180e+02 1.8370586027003293e+02 1.8047930786029582e+02 1.7632908328261061e+02 1.7103664736799030e+02 1.6436334887851021e+02 1.5607155343429136e+02 1.4596272417794725e+02 1.3393607036467259e+02 1.2006531705583203e+02 1.0467811268083587e+02 8.8403316380568597e+01 7.2135662841430104e+01 5.6877501699888121e+01 4.3476244294320182e+01 3.2370018875868084e+01 2.3505286873764881e+01 1.6511318728573318e+01 1.1021624368309196e+01 6.8751399532786142e+00 4.0256247607118860e+00 2.3219137076047933e+00 1.4482271677755167e+00 1.0510780952478973e+00 8.7040736142467001e-01 7.6634176597890247e-01 6.7689225277546872e-01 5.7759491650673167e-01 4.6499893462807057e-01 3.4733194410454626e-01 2.3604127059671301e-01 1.4253248717668748e-01 7.5259482875541781e-02 3.4829443448485792e-02 1.4293760641754723e-02 5.1263353032539169e-03 1.4877940093384685e-03 3.0436895899999954e-04 3.6929366000000115e-05 2.1779719999999981e-06 4.8884999999999753e-08 3.0399999999999962e-10
  8 +2 1.9423029838282417e+02 1.9423028603898280e+02 1.9423026972115292e+02 1.9423024814994437e+02 1.9423021963408144e+02 1.9423018193779706e+02 1.9423013210554268e+02 1.9423006623026063e+02 1.9422997914706036e+02 1.9422986402827362e+02 1.9422971184815057e+02 1.9422951067522573e+02 1.9422924473688082e+02 1.9422889318277805e+02 1.9422842845023339e+02 1.9422781410341412e+02 1.9422700197701363e+02 1.9422592840059147e+02 1.9422450920777285e+02 1.9422263313941147e+02 1.9422015312418461e+02 1.9421687475420609e+02 1.9421254105421704e+02 1.9420681235391802e+02 1.9419923969183816e+02 1.9418922967685018e+02 1.9417599807216124e+02 1.9415850849721932e+02 1.9413539150204903e+02 1.9410483777480928e+02 1.9406445729420605e+02 1.9401109370591490e+02 1.9394057993156218e+02 1.9384741682948786e+02 1.9372435142167092e+02 1.9356182459352726e+02 1.9334725013874481e+02 1.9306407760955329e+02 1.9269058106850059e+02 1.9219830568741349e+02 1.9155009674093986e+02 1.9069763586559796e+02 1.8957842659417759e+02 1.8811222092174697e+02 1.8619698706503760e+02 1.8370472612505139e+02 1.8047780990537822e+02 1.7632710537491505e+02 1.7103403670422944e+02 1.6435990473437238e+02 1.5606701267690877e+02 1.4595674280355584e+02 1.3392820027763415e+02 1.2005497740400266e+02 1.0466455541666045e+02 8.8385586559216364e+01 7.2112555841777848e+01 5.6847522562918272e+01 4.3437579415077607e+01 3.2320538005021923e+01 2.3442604039336643e+01 1.6432952884417521e+01 1.0925309258150332e+01 6.7593259649572026e+00 3.8901726892340882e+00 2.1688767485588616e+00 1.2824488129735021e+00 8.8016732900234851e-01 7.0367593847965737e-01 6.1273572802240517e-01 5.4277651735308396e-01 4.6577332130078236e-01 3.7564927308123158e-01 2.7977951251954719e-01 1.8930510925752125e-01 1.1412747779669413e-01 6.0466543281454017e-02 2.8169609597991214e-02 1.1601824316926180e-02 4.1335833141686300e-03 1.1783820652681261e-03 2.3534649508628885e-04 2.7860712259825271e-05 1.6065517871399497e-06 3.5357701176616288e-08 2.1618915329704446e-10
  9 -1 2.7982674389054046e+02 2.7982672122081573e+02 2.7982669125277846e+02 2.7982665163680821e+02 2.7982659926683135e+02 2.7982653003682719e+02 2.7982643851886974e+02 2.7982631753757875e+02 2.7982615760753737e+02 2.7982594618961741e+02 2.7982566670789589e+02 2.7982529725007510e+02 2.7982480884956925e+02 2.7982416321457049e+02 2.7982330972612306e+02 2.7982218146990510e+02 2.7982068999081645e+02 2.7981871835936232e+02 2.7981611200680288e+02 2.7981266661135771e+02 2.7980811208742085e+02 2.7980209142522227e+02 2.7979413272695797e+02 2.7978361225552504e+02 2.7976970561401362e+02 2.7975132325477983e+02 2.7972702530821857e+02 2.7969490913461107e+02 2.7965246092438116e+02 2.7959635995913351e+02 2.7952222061875477e+02 2.7942425266079772e+02 2.7929481445154408e+02 2.7912382641204249e+02 2.7889800268210723e+02 2.7859984770422585e+02 2.7820635111441214e+02 2.7768729951746968e+02 2.7700310892306339e+02 2.7610207015887471e+02 2.7491689805428899e+02 2.7336049576137452e+02 2.7132090950055226e+02 2.6865559158589286e+02 2.6518536612605129e+02 2.6068898240982270e+02 2.5489994736711233e+02 2.4750854711576523e+02 2.3817360786350227e+02 2.2655034314444023e+02 2.1234170243278709e+02 1.9537899823951241e+02 1.7572991885378715e+02 1.5381465331463454e+02 1.3048381862747578e+02 1.0698707948527165e+02 8.4768996622035473e+01 6.5103845276265261e+01 4.8714337392162896e+01 3.5609308625244324e+01 2.5289196957634644e+01 1.7200415822852996e+01 1.1068374414347678e+01 6.8176911706252596e+00 4.2526901811787816e+00 2.9297253008109694e+00 2.3209017931946780e+00 2.0205383566819166e+00 1.8080349379445768e+00 1.5944062658126348e+00 1.3551716914274090e+00 1.0946461239493739e+00 8.2790489919731458e-01 5.7261125972429117e-01 3.5144061226172740e-01 1.8737693504032790e-01 8.6981308274846306e-02 3.5900048384415482e-02 1.3194618113587499e-02 4.0368927819017476e-03 8.9239082578336092e-04 1.1916611600000001e-04 7.8747989999999951e-06 2.0272199999999977e-07 1.4930000000000005e-09 1.9999999999999935e-12
  9 +0 2.7982674388307311e+02 2.7982672121094578e+02 2.7982669123973216e+02 2.7982665161955805e+02 2.7982659924403083e+02 2.7982653000668552e+02 2.7982643847902511e+02 2.7982631748490581e+02 2.7982615753790657e+02 2.7982594609757126e+02 2.7982566658621676e+02 2.7982529708922158e+02 2.7982480863692939e+02 2.7982416293347438e+02 2.7982330935452973e+02 2.7982218097868144e+02 2.7982068934144650e+02 2.7981871750093563e+02 2.7981611087201179e+02 2.7981266511123380e+02 2.7980811010434496e+02 2.7980208880371737e+02 2.7979412926148672e+02 2.7978360767438357e+02 2.7976969955802804e+02 2.7975131524914889e+02 2.7972701472529178e+02 2.7969489514468319e+02 2.7965244243065723e+02 2.7959633551175801e+02 2.7952218830118329e+02 2.7942420993960542e+02 2.7929475797792344e+02 2.7912375175948290e+02 2.7889790399973469e+02 2.7859971725878239e+02 2.7820617868516479e+02 2.7768707159704866e+02 2.7700280766220061e+02 2.7610167197352791e+02 2.7491637178815267e+02 2.7335980026320647e+02 2.7131999043306473e+02 2.6865437722688034e+02 2.6518376185246433e+02 2.6068686346623889e+02 2.5489714941012451e+02 2.4750485389867833e+02 2.3816873526988857e+02 2.2654391863214840e+02 2.1233323880769467e+02 1.9536786061698740e+02 1.7571528378540498e+02 1.5379545951306415e+02 1.3045870987374494e+02 1.0695434255758931e+02 8.4726501253888031e+01 6.5049000110620469e+01 4.8644086716652872e+01 3.5520209763951840e+01 2.5177635943904157e+01 1.7063032728699351e+01 1.0902763432246529e+01 6.6233852937646285e+00 4.0322999046749963e+00 2.6898630164618407e+00 2.0722716587137349e+00 1.7765599386307178e+00 1.5819471676608292e+00 1.3959735878191533e+00 1.1889913275828989e+00 9.6124801489610778e-01 7.2634723524486910e-01 5.0156494842534050e-01 3.0760946797545147e-01 1.6417827149272715e-01 7.6394839214867671e-02 3.1580760648207300e-02 1.1583985051618695e-02 3.5227117712707113e-03 7.7260320806842270e-04 1.0239165227885636e-04 6.7227930326591504e-06 1.7215600715845982e-07 1.2624758137196973e-09 1.7741657087003497e-12
  9 +1 2.7982674387560678e+02 2.7982672120107594e+02 2.7982669122668472e+02 2.7982665160231062e+02 2.7982659922123003e+02 2.7982652997654486e+02 2.7982643843918061e+02 2.7982631743223351e+02 2.7982615746827673e+02 2.7982594600552522e+02 2.7982566646453654e+02 2.7982529692836772e+02 2.7982480842428987e+02 2.7982416265237754e+02 2.7982330898293674e+02 2.7982218048745739e+02 2.7982068869207711e+02 2.7981871664250821e+02 2.7981610973722150e+02 2.7981266361110829e+02 2.7980810812126941e+02 2.7980208618221110e+02 2.7979412579601461e+02 2.7978360309324165e+02 2.7976969350204257e+02 2.7975130724351891e+02 2.7972700414236493e+02 2.7969488115475497e+02 2.7965242393693279e+02 2.7959631106438354e+02 2.7952215598361238e+02 2.7942416721841408e+02 2.7929470150430467e+02 2.7912367710692200e+02 2.7889780531735374e+02 2.7859958681333239e+02 2.7820600625591459e+02 2.7768684367662621e+02 2.7700250640132475e+02 2.7610127378817981e+02 2.7491584552200180e+02 2.7335910476506382e+02 2.7131907136559488e+02 2.6865316286788681e+02 2.6518215757885650e+02 2.6068474452244612e+02 2.5489435145338285e+02 2.4750116068175390e+02 2.3816386267647729e+02 2.2653749411995418e+02 2.1232477518208859e+02 1.9535672299456482e+02 1.7570064871632235e+02 1.5377626571181835e+02 1.3043360111986300e+02 1.0692160562994199e+02 8.4684005885590906e+01 6.4994154945027233e+01 4.8573836041170836e+01 3.5431110902624894e+01 2.5066074930161317e+01 1.6925649634522276e+01 1.0737152450117064e+01 6.4290794168213763e+00 3.8119096282260161e+00 2.4500007320808113e+00 1.8236415242327806e+00 1.5325815205776330e+00 1.3558593973796214e+00 1.1975409098292180e+00 1.0228109637393372e+00 8.2784990584553320e-01 6.2478957129319068e-01 4.3051863712795413e-01 2.6377832368790016e-01 1.4097960794499528e-01 6.5808370154663537e-02 2.7261472912093809e-02 9.9733519894675982e-03 3.0085307607595085e-03 6.5281559051773243e-04 8.5617188257619309e-05 5.5707873427351485e-06 1.4158972103470181e-07 1.0320771754162306e-09 1.3610871302514968e-12
  9 +2 2.7982674386814250e+02 2.7982672119120707e+02 2.7982669121363688e+02 2.7982665158506137e+02 2.7982659919842945e+02 2.7982652994640284e+02 2.7982643839933473e+02 2.7982631737956035e+02 2.7982615739864798e+02 2.7982594591347794e+02 2.7982566634285712e+02 2.7982529676751477e+02 2.7982480821165137e+02 2.7982416237127973e+02 2.7982330861134494e+02 2.7982217999623293e+02 2.7982068804270853e+02 2.7981871578408004e+02 2.7981610860243143e+02 2.7981266211098301e+02 2.7980810613819392e+02 2.7980208356070466e+02 2.7979412233054381e+02 2.7978359851210047e+02 2.7976968744605756e+02 2.7975129923788853e+02 2.7972699355943763e+02 2.7969486716482788e+02 2.7965240544320943e+02 2.7959628661700862e+02 2.7952212366604414e+02 2.7942412449722360e+02 2.7929464503068493e+02 2.7912360245436344e+02 2.7889770663498234e+02 2.7859945636788740e+02 2.7820583382666888e+02 2.7768661575621195e+02 2.7700220514044651e+02 2.7610087560282625e+02 2.7491531925586628e+02 2.7335840926691844e+02 2.7131815229811826e+02 2.6865194850887957e+02 2.6518055330528597e+02 2.6068262557876028e+02 2.5489155349641069e+02 2.4749746746456060e+02 2.3815899008299624e+02 2.2653106960776333e+02 2.1231631155671764e+02 1.9534558537214096e+02 1.7568601364794543e+02 1.5375707191028263e+02 1.3040849236601417e+02 1.0688886870215028e+02 8.4641510517358469e+01 6.4939309779272861e+01 4.8503585365549228e+01 3.5342012041376108e+01 2.4954513916431967e+01 1.6788266540368141e+01 1.0571541468017601e+01 6.2347735399408295e+00 3.5915193517634862e+00 2.2101384476978567e+00 1.5750113897528297e+00 1.2886031025222850e+00 1.1297716270965905e+00 9.9910823183731667e-01 8.5663059989459156e-01 6.9445179679277236e-01 5.2323190734120806e-01 3.5947232582923910e-01 2.1994717940145087e-01 1.1778094439738455e-01 5.5221901094705504e-02 2.2942185175793543e-02 8.3627189278822501e-03 2.4943497501270246e-03 5.3302797300000049e-04 6.8842723999999847e-05 4.4187820000000261e-06 1.1102300000000042e-07 8.0200000000000085e-10 9.9999999999999675e-13"""


def setup_hf_sto3g_gaussian():
    tmpdir = tempfile.mkdtemp("hipart")
    fn_fchk = os.path.join(tmpdir, "hf.fchk")
    f = open(fn_fchk, "w")
    f.write(hf_fchk)
    f.close()
    fn_densities = os.path.join(tmpdir, "densities.txt")
    f = open(fn_densities, "w")
    f.write(densities_txt)
    f.close()
    return tmpdir, fn_fchk, fn_densities


def iter_hf_sto3g_gaussian_caches():
    options = FakeOptions(110, 50, 1, 1e-4, 500, True)

    tmpdir, fn_fchk, fn_densities = setup_hf_sto3g_gaussian()
    context = Context(fn_fchk, options)
    yield cache_classes['hirsh'].new_from_args(context, [fn_densities])
    yield cache_classes['hirsh'].new_from_args(context, [fn_densities])
    shutil.rmtree(tmpdir)

    tmpdir, fn_fchk, fn_densities = setup_hf_sto3g_gaussian()
    context = Context(fn_fchk, options)
    yield cache_classes['hirshi'].new_from_args(context, [fn_densities])
    yield cache_classes['hirshi'].new_from_args(context, [fn_densities])
    yield cache_classes['hirsh'].new_from_args(context, [fn_densities])
    shutil.rmtree(tmpdir)

    tmpdir, fn_fchk, fn_densities = setup_hf_sto3g_gaussian()
    context = Context(fn_fchk, options)
    yield cache_classes['isa'].new_from_args(context, ["2e-5", "20.0", "100"])
    yield cache_classes['isa'].new_from_args(context, [])
    shutil.rmtree(tmpdir)

    tmpdir, fn_fchk, fn_densities = setup_hf_sto3g_gaussian()
    context = Context(fn_fchk, options)
    yield cache_classes['becke'].new_from_args(context, ["3", "2e-5", "20.0", "100"])
    yield cache_classes['becke'].new_from_args(context, ["3"])
    yield cache_classes['hirshi'].new_from_args(context, [fn_densities])
    shutil.rmtree(tmpdir)


def setup_oh1_sto3g_gaussian():
    tmpdir = tempfile.mkdtemp("hipart")
    fn_fchk = os.path.join(tmpdir, "oh1.fchk")
    f = open(fn_fchk, "w")
    f.write(oh1_fchk)
    f.close()
    fn_densities = os.path.join(tmpdir, "densities.txt")
    f = open(fn_densities, "w")
    f.write(densities_txt)
    f.close()
    return tmpdir, fn_fchk, fn_densities


def iter_oh1_sto3g_gaussian_caches():
    options = FakeOptions(110, 50, 1, 1e-4, 500, True)

    tmpdir, fn_fchk, fn_densities = setup_oh1_sto3g_gaussian()
    context = Context(fn_fchk, options)
    yield cache_classes['hirsh'].new_from_args(context, [fn_densities])
    yield cache_classes['hirsh'].new_from_args(context, [fn_densities])
    shutil.rmtree(tmpdir)

    tmpdir, fn_fchk, fn_densities = setup_oh1_sto3g_gaussian()
    context = Context(fn_fchk, options)
    yield cache_classes['hirshi'].new_from_args(context, [fn_densities])
    yield cache_classes['hirshi'].new_from_args(context, [fn_densities])
    yield cache_classes['hirsh'].new_from_args(context, [fn_densities])
    shutil.rmtree(tmpdir)

    tmpdir, fn_fchk, fn_densities = setup_oh1_sto3g_gaussian()
    context = Context(fn_fchk, options)
    yield cache_classes['isa'].new_from_args(context, ["2e-5", "20.0", "100"])
    yield cache_classes['isa'].new_from_args(context, [])
    shutil.rmtree(tmpdir)


def setup_oh2_sto3g_gaussian():
    tmpdir = tempfile.mkdtemp("hipart")
    fn_fchk = os.path.join(tmpdir, "oh2.fchk")
    f = open(fn_fchk, "w")
    f.write(oh2_fchk)
    f.close()
    fn_densities = os.path.join(tmpdir, "densities.txt")
    f = open(fn_densities, "w")
    f.write(densities_txt)
    f.close()
    return tmpdir, fn_fchk, fn_densities


def iter_oh2_sto3g_gaussian_caches():
    options = FakeOptions(110, 50, 1, 1e-4, 500, True)

    tmpdir, fn_fchk, fn_densities = setup_oh2_sto3g_gaussian()
    context = Context(fn_fchk, options)
    yield cache_classes['hirsh'].new_from_args(context, [fn_densities])
    yield cache_classes['hirsh'].new_from_args(context, [fn_densities])
    shutil.rmtree(tmpdir)

    tmpdir, fn_fchk, fn_densities = setup_oh2_sto3g_gaussian()
    context = Context(fn_fchk, options)
    yield cache_classes['hirshi'].new_from_args(context, [fn_densities])
    yield cache_classes['hirshi'].new_from_args(context, [fn_densities])
    yield cache_classes['hirsh'].new_from_args(context, [fn_densities])
    shutil.rmtree(tmpdir)

    tmpdir, fn_fchk, fn_densities = setup_oh2_sto3g_gaussian()
    context = Context(fn_fchk, options)
    yield cache_classes['isa'].new_from_args(context, ["2e-5", "20.0", "100"])
    yield cache_classes['isa'].new_from_args(context, [])
    shutil.rmtree(tmpdir)


def setup_h_sto3g_gaussian():
    tmpdir = tempfile.mkdtemp("hipart")
    fn_fchk = os.path.join(tmpdir, "h.fchk")
    f = open(fn_fchk, "w")
    f.write(h_fchk)
    f.close()
    fn_densities = os.path.join(tmpdir, "densities.txt")
    f = open(fn_densities, "w")
    f.write(densities_txt)
    f.close()
    return tmpdir, fn_fchk, fn_densities


def iter_h_sto3g_gaussian_caches():
    options = FakeOptions(110, 50, 1, 1e-4, 500, True)

    tmpdir, fn_fchk, fn_densities = setup_h_sto3g_gaussian()
    context = Context(fn_fchk, options)
    yield cache_classes['hirsh'].new_from_args(context, [fn_densities])
    yield cache_classes['hirsh'].new_from_args(context, [fn_densities])
    shutil.rmtree(tmpdir)

    tmpdir, fn_fchk, fn_densities = setup_h_sto3g_gaussian()
    context = Context(fn_fchk, options)
    yield cache_classes['hirshi'].new_from_args(context, [fn_densities])
    yield cache_classes['hirshi'].new_from_args(context, [fn_densities])
    yield cache_classes['hirsh'].new_from_args(context, [fn_densities])
    shutil.rmtree(tmpdir)

    tmpdir, fn_fchk, fn_densities = setup_h_sto3g_gaussian()
    context = Context(fn_fchk, options)
    yield cache_classes['isa'].new_from_args(context, ["2e-5", "20.0", "100"])
    yield cache_classes['isa'].new_from_args(context, [])
    shutil.rmtree(tmpdir)

    tmpdir, fn_fchk, fn_densities = setup_h_sto3g_gaussian()
    context = Context(fn_fchk, options)
    yield cache_classes['becke'].new_from_args(context, ["2e-5", "20.0", "100"])
    yield cache_classes['becke'].new_from_args(context, [])
    shutil.rmtree(tmpdir)
