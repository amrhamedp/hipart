# HiPart is a software toolkit to analyse molecular densities with the hirshfeld partitioning scheme.
# Copyright (C) 2007 - 2010 Toon Verstraelen <Toon.Verstraelen@UGent.be>
#
# This file is part of HiPart.
#
# HiPart is free software; you can redistribute it and/or
# modify it under the terms of the GNU General Public License
# as published by the Free Software Foundation; either version 3
# of the License, or (at your option) any later version.
#
# HiPart is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program; if not, see <http://www.gnu.org/licenses/>
#
# --


from hipart.cache import cache_classes
from hipart.context import Context

import os, tempfile, shutil


__all__ = [
    "FakeOptions",
    "setup_hf_sto3g_gaussian", "iter_hf_sto3g_gaussian_caches",
    "setup_oh1_sto3g_gaussian", "iter_oh1_sto3g_gaussian_caches",
    "setup_oh2_sto3g_gaussian", "iter_oh2_sto3g_gaussian_caches",
]


class FakeOptions(object):
    def __init__(self, lebedev, mol_lebedev, clean, threshold, max_iter, fix_total_charge):
        self.lebedev = lebedev
        self.mol_lebedev = mol_lebedev
        self.clean = clean
        self.threshold = threshold
        self.max_iter = max_iter
        self.fix_total_charge = fix_total_charge


hf_fchk="""\
hcl
SP        RHF                                                         STO-3G
Number of atoms                            I                2
Charge                                     I                0
Multiplicity                               I                1
Number of electrons                        I               10
Number of alpha electrons                  I                5
Number of beta electrons                   I                5
Number of basis functions                  I                6
Number of independant functions            I                6
Number of contracted shells                I                3
Highest angular momentum                   I                1
Largest degree of contraction              I                3
Number of primitive shells                 I                9
SCF Energy                                 R     -9.856961609951867E+01
Total Energy                               R     -9.856961609951867E+01
Atomic numbers                             I   N=           2
           9           1
Nuclear charges                            R   N=           2
  9.00000000E+00  1.00000000E+00
Current cartesian coordinates              R   N=           6
  0.00000000E+00  0.00000000E+00  1.90484394E-01  0.00000000E+00  0.00000000E+00
 -1.71435955E+00
Shell types                                I   N=           3
           0          -1           0
Number of primitives per shell             I   N=           3
           3           3           3
Shell to atom map                          I   N=           3
           1           1           2
Primitive exponents                        R   N=           9
  1.66679134E+02  3.03608123E+01  8.21682067E+00  6.46480325E+00  1.50228124E+00
  4.88588486E-01  3.42525091E+00  6.23913730E-01  1.68855404E-01
Contraction coefficients                   R   N=           9
  1.54328967E-01  5.35328142E-01  4.44634542E-01 -9.99672292E-02  3.99512826E-01
  7.00115469E-01  1.54328967E-01  5.35328142E-01  4.44634542E-01
P(S=P) Contraction coefficients            R   N=           9
  0.00000000E+00  0.00000000E+00  0.00000000E+00  1.55916275E-01  6.07683719E-01
  3.91957393E-01  0.00000000E+00  0.00000000E+00  0.00000000E+00
Alpha Orbital Energies                     R   N=           6
 -2.59083334E+01 -1.44689996E+00 -5.57467136E-01 -4.62288194E-01 -4.62288194E-01
  5.39578910E-01
Alpha MO coefficients                      R   N=          36
  9.94803448E-01  2.18171240E-02  0.00000000E+00  0.00000000E+00 -2.32641328E-03
 -4.79956235E-03 -2.52541943E-01  9.59473606E-01  0.00000000E+00  0.00000000E+00
 -6.43303484E-02  1.39537839E-01 -7.25975847E-02  3.79097630E-01  0.00000000E+00
  0.00000000E+00  6.93582825E-01 -5.48754967E-01  0.00000000E+00  0.00000000E+00
  1.00000000E+00  0.00000000E+00  0.00000000E+00  0.00000000E+00  0.00000000E+00
  0.00000000E+00  0.00000000E+00  1.00000000E+00  0.00000000E+00  0.00000000E+00
  7.48777677E-02 -4.62627490E-01  0.00000000E+00  0.00000000E+00  8.05942415E-01
  1.01124712E+00
Total SCF Density                          R   N=          21
  2.11736348E+00 -4.96250301E-01  2.12956120E+00  0.00000000E+00  0.00000000E+00
  2.00000000E+00  0.00000000E+00  0.00000000E+00  0.00000000E+00  2.00000000E+00
 -7.28413014E-02  4.02323157E-01  0.00000000E+00  0.00000000E+00  9.70401883E-01
 -3.50985618E-04 -1.48507094E-01  0.00000000E+00  0.00000000E+00 -7.79144745E-01
  6.41251717E-01
Dipole Moment                              R   N=           3
  0.00000000E+00  0.00000000E+00 -4.73896291E-01
"""


oh1_fchk = """\
foo
SP        ROHF                                                        STO-3G
Number of atoms                            I                2
Charge                                     I                0
Multiplicity                               I                2
Number of electrons                        I                9
Number of alpha electrons                  I                5
Number of beta electrons                   I                4
Number of basis functions                  I                6
Number of independant functions            I                6
Number of contracted shells                I                3
Highest angular momentum                   I                1
Largest degree of contraction              I                3
Number of primitive shells                 I                9
Virial Ratio                               R      2.004584116380540E+00
SCF Energy                                 R     -7.436007700203925E+01
Total Energy                               R     -7.436007700203925E+01
S**2                                       R      7.500000000000058E-01
S**2 after annihilation                    R      7.499999999999949E-01
RMS Density                                R      8.977997710693391E-06
Atomic numbers                             I   N=           2
           8           1
Nuclear charges                            R   N=           2
  8.00000000E+00  1.00000000E+00
Current cartesian coordinates              R   N=           6
  0.00000000E+00  0.00000000E+00  2.01087858E-01  0.00000000E+00  0.00000000E+00
 -1.60870286E+00
Shell types                                I   N=           3
           0          -1           0
Number of primitives per shell             I   N=           3
           3           3           3
Shell to atom map                          I   N=           3
           1           1           2
Primitive exponents                        R   N=           9
  1.30709321E+02  2.38088661E+01  6.44360831E+00  5.03315132E+00  1.16959612E+00
  3.80388960E-01  3.42525091E+00  6.23913730E-01  1.68855404E-01
Contraction coefficients                   R   N=           9
  1.54328967E-01  5.35328142E-01  4.44634542E-01 -9.99672292E-02  3.99512826E-01
  7.00115469E-01  1.54328967E-01  5.35328142E-01  4.44634542E-01
P(S=P) Contraction coefficients            R   N=           9
  0.00000000E+00  0.00000000E+00  0.00000000E+00  1.55916275E-01  6.07683719E-01
  3.91957393E-01  0.00000000E+00  0.00000000E+00  0.00000000E+00
Coordinates of each shell                  R   N=           9
  0.00000000E+00  0.00000000E+00  2.01087858E-01  0.00000000E+00  0.00000000E+00
  2.01087858E-01  0.00000000E+00  0.00000000E+00 -1.60870286E+00
Alpha Orbital Energies                     R   N=           6
 -2.02663104E+01 -1.18778950E+00 -5.21473569E-01 -3.96170372E-01 -5.50728969E-02
  6.44671667E-01
Alpha MO coefficients                      R   N=          36
  9.94626793E-01  2.33409383E-02  0.00000000E+00  0.00000000E+00 -3.79842004E-03
 -6.61606376E-03 -2.39714989E-01  8.87266774E-01  0.00000000E+00  0.00000000E+00
 -1.24903736E-01  2.13188291E-01 -1.00792420E-01  5.15738267E-01  0.00000000E+00
  0.00000000E+00  6.79754872E-01 -5.07836052E-01  0.00000000E+00  0.00000000E+00
  0.00000000E+00  1.00000000E+00  0.00000000E+00  0.00000000E+00  0.00000000E+00
  0.00000000E+00  1.00000000E+00  0.00000000E+00  0.00000000E+00  0.00000000E+00
  9.30392802E-02 -6.27364884E-01  0.00000000E+00  0.00000000E+00  8.79296022E-01
  1.14823048E+00
Total SCF Density                          R   N=          21
  1.05690485E+00 -2.41458130E-01  1.05377309E+00  0.00000000E+00  0.00000000E+00
  1.00000000E+00  0.00000000E+00  0.00000000E+00  0.00000000E+00  1.00000000E+00
 -4.23508510E-02  2.39664006E-01  0.00000000E+00  0.00000000E+00  4.77682057E-01
 -6.49891854E-03 -7.29100230E-02  0.00000000E+00  0.00000000E+00 -3.71806914E-01
  3.03390475E-01
Dipole Moment                              R   N=           3
  0.00000000E+00  0.00000000E+00 -5.07693653E-01"""


oh2_fchk = """\
foo
SP        UHF                                                         STO-3G
Number of atoms                            I                2
Charge                                     I                0
Multiplicity                               I                2
Number of electrons                        I                9
Number of alpha electrons                  I                5
Number of beta electrons                   I                4
Number of basis functions                  I                6
Number of independant functions            I                6
Number of contracted shells                I                3
Highest angular momentum                   I                1
Largest degree of contraction              I                3
Number of primitive shells                 I                9
Virial Ratio                               R      2.004601758689300E+00
SCF Energy                                 R     -7.436116574636311E+01
Total Energy                               R     -7.436116574636311E+01
S**2                                       R      7.530160094011968E-01
S**2 after annihilation                    R      7.499999999999854E-01
RMS Density                                R      4.253052492946908E-04
Atomic numbers                             I   N=           2
           8           1
Nuclear charges                            R   N=           2
  8.00000000E+00  1.00000000E+00
Current cartesian coordinates              R   N=           6
  0.00000000E+00  0.00000000E+00  2.01087858E-01  0.00000000E+00  0.00000000E+00
 -1.60870286E+00
Shell types                                I   N=           3
           0          -1           0
Number of primitives per shell             I   N=           3
           3           3           3
Shell to atom map                          I   N=           3
           1           1           2
Primitive exponents                        R   N=           9
  1.30709321E+02  2.38088661E+01  6.44360831E+00  5.03315132E+00  1.16959612E+00
  3.80388960E-01  3.42525091E+00  6.23913730E-01  1.68855404E-01
Contraction coefficients                   R   N=           9
  1.54328967E-01  5.35328142E-01  4.44634542E-01 -9.99672292E-02  3.99512826E-01
  7.00115469E-01  1.54328967E-01  5.35328142E-01  4.44634542E-01
P(S=P) Contraction coefficients            R   N=           9
  0.00000000E+00  0.00000000E+00  0.00000000E+00  1.55916275E-01  6.07683719E-01
  3.91957393E-01  0.00000000E+00  0.00000000E+00  0.00000000E+00
Coordinates of each shell                  R   N=           9
  0.00000000E+00  0.00000000E+00  2.01087858E-01  0.00000000E+00  0.00000000E+00
  2.01087858E-01  0.00000000E+00  0.00000000E+00 -1.60870286E+00
Alpha Orbital Energies                     R   N=           6
 -2.02850453E+01 -1.29590853E+00 -5.53744083E-01 -5.24956112E-01 -4.30067224E-01
  6.32677753E-01
Beta Orbital Energies                      R   N=           6
 -2.02565946E+01 -1.13271582E+00 -5.05316759E-01 -3.78250103E-01  3.59575654E-01
  6.68548659E-01
Alpha MO coefficients                      R   N=          36
  9.94266794E-01  2.48147786E-02  0.00000000E+00  0.00000000E+00 -3.90932760E-03
 -6.91535080E-03 -2.46670414E-01  9.20063389E-01  0.00000000E+00  0.00000000E+00
 -1.15476493E-01  1.68822174E-01 -8.98413185E-02  4.68633688E-01  0.00000000E+00
  0.00000000E+00  6.99702718E-01 -4.95493556E-01  0.00000000E+00  0.00000000E+00
  1.00000000E+00  0.00000000E+00  0.00000000E+00  0.00000000E+00  0.00000000E+00
  0.00000000E+00  0.00000000E+00  1.00000000E+00  0.00000000E+00  0.00000000E+00
  8.98717940E-02 -6.16935846E-01  0.00000000E+00  0.00000000E+00  8.64817642E-01
  1.16093113E+00
Beta MO coefficients                       R   N=          36
  9.94821161E-01  2.25101424E-02  0.00000000E+00  0.00000000E+00 -3.61993202E-03
 -6.31368233E-03 -2.34464044E-01  8.60158617E-01  0.00000000E+00  0.00000000E+00
 -1.20553720E-01  2.51547643E-01 -1.07687799E-01  5.46428719E-01  0.00000000E+00
  0.00000000E+00  6.62941723E-01 -5.20224255E-01  0.00000000E+00  0.00000000E+00
  0.00000000E+00  1.00000000E+00  0.00000000E+00  0.00000000E+00  0.00000000E+00
  0.00000000E+00  1.00000000E+00  0.00000000E+00  0.00000000E+00  0.00000000E+00
  9.65503007E-02 -6.39058594E-01  0.00000000E+00  0.00000000E+00  8.92639636E-01
  1.13484552E+00
Total SCF Density                          R   N=          21
  2.11372341E+00 -4.82508983E-01  2.10571384E+00  0.00000000E+00  0.00000000E+00
  1.00000000E+00  0.00000000E+00  0.00000000E+00  0.00000000E+00  2.00000000E+00
 -8.49909024E-02  4.80035153E-01  0.00000000E+00  0.00000000E+00  9.56972029E-01
 -1.32414023E-02 -1.45086196E-01  0.00000000E+00  0.00000000E+00 -7.41346659E-01
  6.08011967E-01
Spin SCF Density                           R   N=          21
  1.24502121E-03 -6.25616822E-03  2.77860492E-02  0.00000000E+00  0.00000000E+00
  1.00000000E+00  0.00000000E+00  0.00000000E+00  0.00000000E+00  0.00000000E+00
  8.46191231E-03 -3.69120275E-02  0.00000000E+00  0.00000000E+00  4.88959654E-02
  5.23471257E-03 -9.01275220E-03  0.00000000E+00  0.00000000E+00  9.01436638E-03
 -5.98867416E-02
Dipole Moment                              R   N=           3
  0.00000000E+00  0.00000000E+00 -5.08603120E-01"""


densities_txt="""\
Radii [bohr]               3.7794523e-05 4.3454517e-05 4.9962135e-05 5.7444314e-05 6.6047002e-05 7.5938002e-05 8.7310249e-05 1.0038557e-04 1.1541901e-04 1.3270382e-04 1.5257714e-04 1.7542663e-04 2.0169800e-04 2.3190369e-04 2.6663289e-04 3.0656303e-04 3.5247298e-04 4.0525828e-04 4.6594854e-04 5.3572759e-04 6.1595655e-04 7.0820035e-04 8.1425831e-04 9.3619919e-04 1.0764016e-03 1.2376002e-03 1.4229395e-03 1.6360347e-03 1.8810423e-03 2.1627415e-03 2.4866272e-03 2.8590170e-03 3.2871748e-03 3.7794523e-03 4.3454517e-03 4.9962135e-03 5.7444314e-03 6.6047002e-03 7.5938002e-03 8.7310249e-03 1.0038557e-02 1.1541901e-02 1.3270382e-02 1.5257714e-02 1.7542663e-02 2.0169800e-02 2.3190369e-02 2.6663289e-02 3.0656303e-02 3.5247298e-02 4.0525828e-02 4.6594854e-02 5.3572759e-02 6.1595655e-02 7.0820035e-02 8.1425831e-02 9.3619919e-02 1.0764016e-01 1.2376002e-01 1.4229395e-01 1.6360347e-01 1.8810423e-01 2.1627415e-01 2.4866272e-01 2.8590170e-01 3.2871748e-01 3.7794523e-01 4.3454517e-01 4.9962135e-01 5.7444314e-01 6.6047002e-01 7.5938002e-01 8.7310249e-01 1.0038557e+00 1.1541901e+00 1.3270382e+00 1.5257714e+00 1.7542663e+00 2.0169800e+00 2.3190369e+00 2.6663289e+00 3.0656303e+00 3.5247298e+00 4.0525828e+00 4.6594854e+00 5.3572759e+00 6.1595655e+00 7.0820035e+00 8.1425831e+00 9.3619919e+00 1.0764016e+01 1.2376002e+01 1.4229395e+01 1.6360347e+01 1.8810423e+01 2.1627415e+01 2.4866272e+01 2.8590170e+01 3.2871748e+01 3.7794523e+01
Densities   1  H -1 [a.u.] 7.8938827e-01 7.8938827e-01 7.8938827e-01 7.8938827e-01 7.8938826e-01 7.8938826e-01 7.8938826e-01 7.8938825e-01 7.8938824e-01 7.8938823e-01 7.8938821e-01 7.8938819e-01 7.8938816e-01 7.8938812e-01 7.8938807e-01 7.8938801e-01 7.8938792e-01 7.8938781e-01 7.8938766e-01 7.8938746e-01 7.8938720e-01 7.8938685e-01 7.8938639e-01 7.8938579e-01 7.8938499e-01 7.8938393e-01 7.8938253e-01 7.8938068e-01 7.8937823e-01 7.8937500e-01 7.8937072e-01 7.8936507e-01 7.8935760e-01 7.8934772e-01 7.8933467e-01 7.8931741e-01 7.8929460e-01 7.8926444e-01 7.8922458e-01 7.8917189e-01 7.8910224e-01 7.8901018e-01 7.8888851e-01 7.8872771e-01 7.8851520e-01 7.8823439e-01 7.8786338e-01 7.8737329e-01 7.8672603e-01 7.8587148e-01 7.8474370e-01 7.8325613e-01 7.8129540e-01 7.7871341e-01 7.7531755e-01 7.7085856e-01 7.6501625e-01 7.5738322e-01 7.4744792e-01 7.3457954e-01 7.1801981e-01 6.9689003e-01 6.7022649e-01 6.3706248e-01 5.9657755e-01 5.4832953e-01 4.9256132e-01 4.3052396e-01 3.6468029e-01 2.9858738e-01 2.3628804e-01 1.8126709e-01 1.3540428e-01 9.8584312e-02 6.9344194e-02 4.6169214e-02 2.8374448e-02 1.5812231e-02 7.9779437e-03 3.6998898e-03 1.6022270e-03 6.3623822e-04 2.1463809e-04 5.4569861e-05 9.1208690e-06 8.6052400e-07 3.7983000e-08 6.1400000e-10 3.0000000e-12 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00
Densities   1  H +0 [a.u.] 3.9469414e-01 3.9469414e-01 3.9469413e-01 3.9469413e-01 3.9469413e-01 3.9469413e-01 3.9469413e-01 3.9469412e-01 3.9469412e-01 3.9469411e-01 3.9469411e-01 3.9469409e-01 3.9469408e-01 3.9469406e-01 3.9469404e-01 3.9469400e-01 3.9469396e-01 3.9469391e-01 3.9469383e-01 3.9469373e-01 3.9469360e-01 3.9469343e-01 3.9469320e-01 3.9469289e-01 3.9469249e-01 3.9469196e-01 3.9469126e-01 3.9469034e-01 3.9468912e-01 3.9468750e-01 3.9468536e-01 3.9468254e-01 3.9467880e-01 3.9467386e-01 3.9466733e-01 3.9465871e-01 3.9464730e-01 3.9463222e-01 3.9461229e-01 3.9458594e-01 3.9455112e-01 3.9450509e-01 3.9444426e-01 3.9436385e-01 3.9425760e-01 3.9411719e-01 3.9393169e-01 3.9368664e-01 3.9336301e-01 3.9293574e-01 3.9237185e-01 3.9162807e-01 3.9064770e-01 3.8935671e-01 3.8765878e-01 3.8542928e-01 3.8250813e-01 3.7869161e-01 3.7372396e-01 3.6728977e-01 3.5900991e-01 3.4844502e-01 3.3511325e-01 3.1853124e-01 2.9828878e-01 2.7416476e-01 2.4628066e-01 2.1526198e-01 1.8234015e-01 1.4929369e-01 1.1814402e-01 9.0633543e-02 6.7702140e-02 4.9292156e-02 3.4672097e-02 2.3084607e-02 1.4187224e-02 7.9061155e-03 3.9889719e-03 1.8499449e-03 8.0111348e-04 3.1811911e-04 1.0731904e-04 2.7284930e-05 4.5604340e-06 4.3026200e-07 1.8991000e-08 3.0700000e-10 1.0000000e-12 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00
Densities   8  O -2 [a.u.] 1.9423030e+02 1.9423029e+02 1.9423027e+02 1.9423025e+02 1.9423022e+02 1.9423018e+02 1.9423013e+02 1.9423007e+02 1.9422998e+02 1.9422986e+02 1.9422971e+02 1.9422951e+02 1.9422925e+02 1.9422889e+02 1.9422843e+02 1.9422782e+02 1.9422700e+02 1.9422593e+02 1.9422451e+02 1.9422264e+02 1.9422016e+02 1.9421688e+02 1.9421255e+02 1.9420682e+02 1.9419925e+02 1.9418925e+02 1.9417602e+02 1.9415854e+02 1.9413543e+02 1.9410489e+02 1.9406453e+02 1.9401119e+02 1.9394070e+02 1.9384758e+02 1.9372456e+02 1.9356210e+02 1.9334762e+02 1.9306457e+02 1.9269123e+02 1.9219916e+02 1.9155122e+02 1.9069912e+02 1.8958039e+02 1.8811482e+02 1.8620042e+02 1.8370926e+02 1.8048380e+02 1.7633502e+02 1.7104448e+02 1.6437368e+02 1.5608518e+02 1.4598067e+02 1.3395968e+02 1.2009634e+02 1.0471878e+02 8.8456506e+01 7.2204984e+01 5.6967439e+01 4.3592239e+01 3.2518461e+01 2.3693335e+01 1.6746416e+01 1.1310570e+01 7.2225819e+00 4.4319810e+00 2.7810246e+00 1.9455622e+00 1.5638104e+00 1.3706016e+00 1.2271599e+00 1.0792395e+00 9.1305970e-01 7.3304792e-01 5.4998924e-01 3.7624975e-01 2.2774752e-01 1.1963830e-01 5.4808945e-02 2.2369570e-02 8.1045913e-03 2.4160298e-03 5.1143635e-04 6.4135327e-05 3.8922330e-06 8.9465000e-08 5.6700000e-10 1.0000000e-12 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00
Densities   8  O -1 [a.u.] 1.9423030e+02 1.9423029e+02 1.9423027e+02 1.9423025e+02 1.9423022e+02 1.9423018e+02 1.9423013e+02 1.9423007e+02 1.9422998e+02 1.9422986e+02 1.9422971e+02 1.9422951e+02 1.9422925e+02 1.9422889e+02 1.9422843e+02 1.9422781e+02 1.9422700e+02 1.9422593e+02 1.9422451e+02 1.9422264e+02 1.9422016e+02 1.9421688e+02 1.9421255e+02 1.9420682e+02 1.9419925e+02 1.9418924e+02 1.9417602e+02 1.9415853e+02 1.9413542e+02 1.9410488e+02 1.9406451e+02 1.9401116e+02 1.9394067e+02 1.9384754e+02 1.9372451e+02 1.9356203e+02 1.9334753e+02 1.9306444e+02 1.9269106e+02 1.9219894e+02 1.9155094e+02 1.9069875e+02 1.8957990e+02 1.8811417e+02 1.8619956e+02 1.8370813e+02 1.8048230e+02 1.7633304e+02 1.7104187e+02 1.6437024e+02 1.5608063e+02 1.4597469e+02 1.3395181e+02 1.2008600e+02 1.0470523e+02 8.8438776e+01 7.2181877e+01 5.6937460e+01 4.3553574e+01 3.2468981e+01 2.3630653e+01 1.6668050e+01 1.1214255e+01 7.1067679e+00 4.2965289e+00 2.6279876e+00 1.7797839e+00 1.3928996e+00 1.2038702e+00 1.0735538e+00 9.4512372e-01 8.0123811e-01 6.4369826e-01 4.8243681e-01 3.2951359e-01 1.9934251e-01 1.0484536e-01 4.8149111e-02 1.9677633e-02 7.1118393e-03 2.1066179e-03 4.4241389e-04 5.5066673e-05 3.3208124e-06 7.5938287e-08 4.7924927e-10 6.9765898e-13 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00
Densities   8  O +0 [a.u.] 1.9423030e+02 1.9423029e+02 1.9423027e+02 1.9423025e+02 1.9423022e+02 1.9423018e+02 1.9423013e+02 1.9423007e+02 1.9422998e+02 1.9422986e+02 1.9422971e+02 1.9422951e+02 1.9422924e+02 1.9422889e+02 1.9422843e+02 1.9422781e+02 1.9422700e+02 1.9422593e+02 1.9422451e+02 1.9422263e+02 1.9422016e+02 1.9421688e+02 1.9421254e+02 1.9420682e+02 1.9419925e+02 1.9418924e+02 1.9417601e+02 1.9415852e+02 1.9413541e+02 1.9410486e+02 1.9406449e+02 1.9401114e+02 1.9394064e+02 1.9384750e+02 1.9372446e+02 1.9356196e+02 1.9334743e+02 1.9306432e+02 1.9269090e+02 1.9219873e+02 1.9155066e+02 1.9069838e+02 1.8957941e+02 1.8811352e+02 1.8619870e+02 1.8370699e+02 1.8048081e+02 1.7633106e+02 1.7103926e+02 1.6436679e+02 1.5607609e+02 1.4596871e+02 1.3394394e+02 1.2007566e+02 1.0469167e+02 8.8421046e+01 7.2158770e+01 5.6907481e+01 4.3514909e+01 3.2419500e+01 2.3567970e+01 1.6589685e+01 1.1117939e+01 6.9909539e+00 4.1610768e+00 2.4749507e+00 1.6140055e+00 1.2219889e+00 1.0371388e+00 9.1994780e-01 8.1100799e-01 6.8941651e-01 5.5434860e-01 4.1488438e-01 2.8277743e-01 1.7093750e-01 9.0052422e-02 4.1489277e-02 1.6985697e-02 6.1190873e-03 1.7972060e-03 3.7339142e-04 4.5998020e-05 2.7493922e-06 6.2411423e-08 3.9157899e-10 2.9061584e-13 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00
Densities   8  O +1 [a.u.] 1.9423030e+02 1.9423029e+02 1.9423027e+02 1.9423025e+02 1.9423022e+02 1.9423018e+02 1.9423013e+02 1.9423007e+02 1.9422998e+02 1.9422986e+02 1.9422971e+02 1.9422951e+02 1.9422924e+02 1.9422889e+02 1.9422843e+02 1.9422781e+02 1.9422700e+02 1.9422593e+02 1.9422451e+02 1.9422263e+02 1.9422015e+02 1.9421688e+02 1.9421254e+02 1.9420681e+02 1.9419924e+02 1.9418923e+02 1.9417600e+02 1.9415852e+02 1.9413540e+02 1.9410485e+02 1.9406447e+02 1.9401112e+02 1.9394061e+02 1.9384746e+02 1.9372440e+02 1.9356189e+02 1.9334734e+02 1.9306420e+02 1.9269074e+02 1.9219852e+02 1.9155038e+02 1.9069801e+02 1.8957892e+02 1.8811287e+02 1.8619785e+02 1.8370586e+02 1.8047931e+02 1.7632908e+02 1.7103665e+02 1.6436335e+02 1.5607155e+02 1.4596272e+02 1.3393607e+02 1.2006532e+02 1.0467811e+02 8.8403316e+01 7.2135663e+01 5.6877502e+01 4.3476244e+01 3.2370019e+01 2.3505287e+01 1.6511319e+01 1.1021624e+01 6.8751400e+00 4.0256248e+00 2.3219137e+00 1.4482272e+00 1.0510781e+00 8.7040736e-01 7.6634177e-01 6.7689225e-01 5.7759492e-01 4.6499893e-01 3.4733194e-01 2.3604127e-01 1.4253249e-01 7.5259483e-02 3.4829443e-02 1.4293761e-02 5.1263353e-03 1.4877940e-03 3.0436896e-04 3.6929366e-05 2.1779720e-06 4.8885000e-08 3.0400000e-10 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00
Densities   8  O +2 [a.u.] 1.9423030e+02 1.9423029e+02 1.9423027e+02 1.9423025e+02 1.9423022e+02 1.9423018e+02 1.9423013e+02 1.9423007e+02 1.9422998e+02 1.9422986e+02 1.9422971e+02 1.9422951e+02 1.9422924e+02 1.9422889e+02 1.9422843e+02 1.9422781e+02 1.9422700e+02 1.9422593e+02 1.9422451e+02 1.9422263e+02 1.9422015e+02 1.9421687e+02 1.9421254e+02 1.9420681e+02 1.9419924e+02 1.9418923e+02 1.9417600e+02 1.9415851e+02 1.9413539e+02 1.9410484e+02 1.9406446e+02 1.9401109e+02 1.9394058e+02 1.9384742e+02 1.9372435e+02 1.9356182e+02 1.9334725e+02 1.9306408e+02 1.9269058e+02 1.9219831e+02 1.9155010e+02 1.9069764e+02 1.8957843e+02 1.8811222e+02 1.8619699e+02 1.8370473e+02 1.8047781e+02 1.7632711e+02 1.7103404e+02 1.6435990e+02 1.5606701e+02 1.4595674e+02 1.3392820e+02 1.2005498e+02 1.0466456e+02 8.8385587e+01 7.2112556e+01 5.6847523e+01 4.3437579e+01 3.2320538e+01 2.3442604e+01 1.6432953e+01 1.0925309e+01 6.7593260e+00 3.8901727e+00 2.1688767e+00 1.2824488e+00 8.8016733e-01 7.0367594e-01 6.1273573e-01 5.4277652e-01 4.6577332e-01 3.7564927e-01 2.7977951e-01 1.8930511e-01 1.1412748e-01 6.0466543e-02 2.8169610e-02 1.1601824e-02 4.1335833e-03 1.1783821e-03 2.3534650e-04 2.7860712e-05 1.6065518e-06 3.5357701e-08 2.1618915e-10 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00
Densities   9  F -1 [a.u.] 2.7982674e+02 2.7982672e+02 2.7982669e+02 2.7982665e+02 2.7982660e+02 2.7982653e+02 2.7982644e+02 2.7982632e+02 2.7982616e+02 2.7982595e+02 2.7982567e+02 2.7982530e+02 2.7982481e+02 2.7982416e+02 2.7982331e+02 2.7982218e+02 2.7982069e+02 2.7981872e+02 2.7981611e+02 2.7981267e+02 2.7980811e+02 2.7980209e+02 2.7979413e+02 2.7978361e+02 2.7976971e+02 2.7975132e+02 2.7972703e+02 2.7969491e+02 2.7965246e+02 2.7959636e+02 2.7952222e+02 2.7942425e+02 2.7929481e+02 2.7912383e+02 2.7889800e+02 2.7859985e+02 2.7820635e+02 2.7768730e+02 2.7700311e+02 2.7610207e+02 2.7491690e+02 2.7336050e+02 2.7132091e+02 2.6865559e+02 2.6518537e+02 2.6068898e+02 2.5489995e+02 2.4750855e+02 2.3817361e+02 2.2655034e+02 2.1234170e+02 1.9537900e+02 1.7572992e+02 1.5381465e+02 1.3048382e+02 1.0698708e+02 8.4768997e+01 6.5103845e+01 4.8714337e+01 3.5609309e+01 2.5289197e+01 1.7200416e+01 1.1068374e+01 6.8176912e+00 4.2526902e+00 2.9297253e+00 2.3209018e+00 2.0205384e+00 1.8080349e+00 1.5944063e+00 1.3551717e+00 1.0946461e+00 8.2790490e-01 5.7261126e-01 3.5144061e-01 1.8737694e-01 8.6981308e-02 3.5900048e-02 1.3194618e-02 4.0368928e-03 8.9239083e-04 1.1916612e-04 7.8747990e-06 2.0272200e-07 1.4930000e-09 2.0000000e-12 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00
Densities   9  F +0 [a.u.] 2.7982674e+02 2.7982672e+02 2.7982669e+02 2.7982665e+02 2.7982660e+02 2.7982653e+02 2.7982644e+02 2.7982632e+02 2.7982616e+02 2.7982595e+02 2.7982567e+02 2.7982530e+02 2.7982481e+02 2.7982416e+02 2.7982331e+02 2.7982218e+02 2.7982069e+02 2.7981872e+02 2.7981611e+02 2.7981267e+02 2.7980811e+02 2.7980209e+02 2.7979413e+02 2.7978361e+02 2.7976970e+02 2.7975132e+02 2.7972701e+02 2.7969490e+02 2.7965244e+02 2.7959634e+02 2.7952219e+02 2.7942421e+02 2.7929476e+02 2.7912375e+02 2.7889790e+02 2.7859972e+02 2.7820618e+02 2.7768707e+02 2.7700281e+02 2.7610167e+02 2.7491637e+02 2.7335980e+02 2.7131999e+02 2.6865438e+02 2.6518376e+02 2.6068686e+02 2.5489715e+02 2.4750485e+02 2.3816874e+02 2.2654392e+02 2.1233324e+02 1.9536786e+02 1.7571528e+02 1.5379546e+02 1.3045871e+02 1.0695434e+02 8.4726501e+01 6.5049000e+01 4.8644087e+01 3.5520210e+01 2.5177636e+01 1.7063033e+01 1.0902763e+01 6.6233853e+00 4.0322999e+00 2.6898630e+00 2.0722717e+00 1.7765599e+00 1.5819472e+00 1.3959736e+00 1.1889913e+00 9.6124801e-01 7.2634724e-01 5.0156495e-01 3.0760947e-01 1.6417827e-01 7.6394839e-02 3.1580761e-02 1.1583985e-02 3.5227118e-03 7.7260321e-04 1.0239165e-04 6.7227930e-06 1.7215601e-07 1.2624758e-09 1.7741657e-12 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00
Densities   9  F +1 [a.u.] 2.7982674e+02 2.7982672e+02 2.7982669e+02 2.7982665e+02 2.7982660e+02 2.7982653e+02 2.7982644e+02 2.7982632e+02 2.7982616e+02 2.7982595e+02 2.7982567e+02 2.7982530e+02 2.7982481e+02 2.7982416e+02 2.7982331e+02 2.7982218e+02 2.7982069e+02 2.7981872e+02 2.7981611e+02 2.7981266e+02 2.7980811e+02 2.7980209e+02 2.7979413e+02 2.7978360e+02 2.7976969e+02 2.7975131e+02 2.7972700e+02 2.7969488e+02 2.7965242e+02 2.7959631e+02 2.7952216e+02 2.7942417e+02 2.7929470e+02 2.7912368e+02 2.7889781e+02 2.7859959e+02 2.7820601e+02 2.7768684e+02 2.7700251e+02 2.7610127e+02 2.7491585e+02 2.7335910e+02 2.7131907e+02 2.6865316e+02 2.6518216e+02 2.6068474e+02 2.5489435e+02 2.4750116e+02 2.3816386e+02 2.2653749e+02 2.1232478e+02 1.9535672e+02 1.7570065e+02 1.5377627e+02 1.3043360e+02 1.0692161e+02 8.4684006e+01 6.4994155e+01 4.8573836e+01 3.5431111e+01 2.5066075e+01 1.6925650e+01 1.0737152e+01 6.4290794e+00 3.8119096e+00 2.4500007e+00 1.8236415e+00 1.5325815e+00 1.3558594e+00 1.1975409e+00 1.0228110e+00 8.2784991e-01 6.2478957e-01 4.3051864e-01 2.6377832e-01 1.4097961e-01 6.5808370e-02 2.7261473e-02 9.9733520e-03 3.0085308e-03 6.5281559e-04 8.5617188e-05 5.5707873e-06 1.4158972e-07 1.0320772e-09 1.3610871e-12 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00
Densities   9  F +2 [a.u.] 2.7982674e+02 2.7982672e+02 2.7982669e+02 2.7982665e+02 2.7982660e+02 2.7982653e+02 2.7982644e+02 2.7982632e+02 2.7982616e+02 2.7982595e+02 2.7982567e+02 2.7982530e+02 2.7982481e+02 2.7982416e+02 2.7982331e+02 2.7982218e+02 2.7982069e+02 2.7981872e+02 2.7981611e+02 2.7981266e+02 2.7980811e+02 2.7980208e+02 2.7979412e+02 2.7978360e+02 2.7976969e+02 2.7975130e+02 2.7972699e+02 2.7969487e+02 2.7965241e+02 2.7959629e+02 2.7952212e+02 2.7942412e+02 2.7929465e+02 2.7912360e+02 2.7889771e+02 2.7859946e+02 2.7820583e+02 2.7768662e+02 2.7700221e+02 2.7610088e+02 2.7491532e+02 2.7335841e+02 2.7131815e+02 2.6865195e+02 2.6518055e+02 2.6068263e+02 2.5489155e+02 2.4749747e+02 2.3815899e+02 2.2653107e+02 2.1231631e+02 1.9534559e+02 1.7568601e+02 1.5375707e+02 1.3040849e+02 1.0688887e+02 8.4641511e+01 6.4939310e+01 4.8503585e+01 3.5342012e+01 2.4954514e+01 1.6788267e+01 1.0571541e+01 6.2347735e+00 3.5915194e+00 2.2101384e+00 1.5750114e+00 1.2886031e+00 1.1297716e+00 9.9910823e-01 8.5663060e-01 6.9445180e-01 5.2323191e-01 3.5947233e-01 2.1994718e-01 1.1778094e-01 5.5221901e-02 2.2942185e-02 8.3627189e-03 2.4943498e-03 5.3302797e-04 6.8842724e-05 4.4187820e-06 1.1102300e-07 8.0200000e-10 1.0000000e-12 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00"""


def setup_hf_sto3g_gaussian():
    tmpdir = tempfile.mkdtemp("hipart")
    fn_fchk = os.path.join(tmpdir, "hf.fchk")
    f = open(fn_fchk, "w")
    f.write(hf_fchk)
    f.close()
    fn_densities = os.path.join(tmpdir, "densities.txt")
    f = open(fn_densities, "w")
    f.write(densities_txt)
    f.close()
    return tmpdir, fn_fchk, fn_densities


def iter_hf_sto3g_gaussian_caches():
    options = FakeOptions(110, 50, 1, 1e-4, 500, True)

    tmpdir, fn_fchk, fn_densities = setup_hf_sto3g_gaussian()
    context = Context(fn_fchk, options)
    yield cache_classes['hirsh'].new_from_args(context, [fn_densities])
    yield cache_classes['hirsh'].new_from_args(context, [fn_densities])
    shutil.rmtree(tmpdir)

    tmpdir, fn_fchk, fn_densities = setup_hf_sto3g_gaussian()
    context = Context(fn_fchk, options)
    yield cache_classes['hirshi'].new_from_args(context, [fn_densities])
    yield cache_classes['hirshi'].new_from_args(context, [fn_densities])
    yield cache_classes['hirsh'].new_from_args(context, [fn_densities])
    shutil.rmtree(tmpdir)

    tmpdir, fn_fchk, fn_densities = setup_hf_sto3g_gaussian()
    context = Context(fn_fchk, options)
    yield cache_classes['isa'].new_from_args(context, ["2e-5", "20.0", "100"])
    yield cache_classes['isa'].new_from_args(context, [])
    shutil.rmtree(tmpdir)


def setup_oh1_sto3g_gaussian():
    tmpdir = tempfile.mkdtemp("hipart")
    fn_fchk = os.path.join(tmpdir, "oh1.fchk")
    f = open(fn_fchk, "w")
    f.write(oh1_fchk)
    f.close()
    fn_densities = os.path.join(tmpdir, "densities.txt")
    f = open(fn_densities, "w")
    f.write(densities_txt)
    f.close()
    return tmpdir, fn_fchk, fn_densities


def iter_oh1_sto3g_gaussian_caches():
    options = FakeOptions(110, 50, 1, 1e-4, 500, True)

    tmpdir, fn_fchk, fn_densities = setup_oh1_sto3g_gaussian()
    context = Context(fn_fchk, options)
    yield cache_classes['hirsh'].new_from_args(context, [fn_densities])
    yield cache_classes['hirsh'].new_from_args(context, [fn_densities])
    shutil.rmtree(tmpdir)

    tmpdir, fn_fchk, fn_densities = setup_oh1_sto3g_gaussian()
    context = Context(fn_fchk, options)
    yield cache_classes['hirshi'].new_from_args(context, [fn_densities])
    yield cache_classes['hirshi'].new_from_args(context, [fn_densities])
    yield cache_classes['hirsh'].new_from_args(context, [fn_densities])
    shutil.rmtree(tmpdir)

    tmpdir, fn_fchk, fn_densities = setup_oh1_sto3g_gaussian()
    context = Context(fn_fchk, options)
    yield cache_classes['isa'].new_from_args(context, ["2e-5", "20.0", "100"])
    yield cache_classes['isa'].new_from_args(context, [])
    shutil.rmtree(tmpdir)


def setup_oh2_sto3g_gaussian():
    tmpdir = tempfile.mkdtemp("hipart")
    fn_fchk = os.path.join(tmpdir, "oh2.fchk")
    f = open(fn_fchk, "w")
    f.write(oh2_fchk)
    f.close()
    fn_densities = os.path.join(tmpdir, "densities.txt")
    f = open(fn_densities, "w")
    f.write(densities_txt)
    f.close()
    return tmpdir, fn_fchk, fn_densities


def iter_oh2_sto3g_gaussian_caches():
    options = FakeOptions(110, 50, 1, 1e-4, 500, True)

    tmpdir, fn_fchk, fn_densities = setup_oh2_sto3g_gaussian()
    context = Context(fn_fchk, options)
    yield cache_classes['hirsh'].new_from_args(context, [fn_densities])
    yield cache_classes['hirsh'].new_from_args(context, [fn_densities])
    shutil.rmtree(tmpdir)

    tmpdir, fn_fchk, fn_densities = setup_oh2_sto3g_gaussian()
    context = Context(fn_fchk, options)
    yield cache_classes['hirshi'].new_from_args(context, [fn_densities])
    yield cache_classes['hirshi'].new_from_args(context, [fn_densities])
    yield cache_classes['hirsh'].new_from_args(context, [fn_densities])
    shutil.rmtree(tmpdir)

    tmpdir, fn_fchk, fn_densities = setup_oh2_sto3g_gaussian()
    context = Context(fn_fchk, options)
    yield cache_classes['isa'].new_from_args(context, ["2e-5", "20.0", "100"])
    yield cache_classes['isa'].new_from_args(context, [])
    shutil.rmtree(tmpdir)
